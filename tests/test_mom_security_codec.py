#!/usr/bin/env python
# -*- coding: utf-8 -*-

import unittest2
from mom.security.codec import public_key_pem_decode, private_key_pem_decode

private_key='''
-----BEGIN PRIVATE KEY-----
MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBALRiMLAh9iimur8V
A7qVvdqxevEuUkW4K+2KdMXmnQbG9Aa7k7eBjK1S+0LYmVjPKlJGNXHDGuy5Fw/d
7rjVJ0BLB+ubPK8iA/Tw3hLQgXMRRGRXXCn8ikfuQfjUS1uZSatdLB81mydBETlJ
hI6GH4twrbDJCR2Bwy/XWXgqgGRzAgMBAAECgYBYWVtleUzavkbrPjy0T5FMou8H
X9u2AC2ry8vD/l7cqedtwMPp9k7TubgNFo+NGvKsl2ynyprOZR1xjQ7WgrgVB+mm
uScOM/5HVceFuGRDhYTCObE+y1kxRloNYXnx3ei1zbeYLPCHdhxRYW7T0qcynNmw
rn05/KO2RLjgQNalsQJBANeA3Q4Nugqy4QBUCEC09SqylT2K9FrrItqL2QKc9v0Z
zO2uwllCbg0dwpVuYPYXYvikNHHg+aCWF+VXsb9rpPsCQQDWR9TT4ORdzoj+Nccn
qkMsDmzt0EfNaAOwHOmVJ2RVBspPcxt5iN4HI7HNeG6U5YsFBb+/GZbgfBT3kpNG
WPTpAkBI+gFhjfJvRw38n3g/+UeAkwMI2TJQS4n8+hid0uus3/zOjDySH3XHCUno
cn1xOJAyZODBo47E+67R4jV1/gzbAkEAklJaspRPXP877NssM5nAZMU0/O/NGCZ+
3jPgDUno6WbJn5cqm8MqWhW1xGkImgRk+fkDBquiq4gPiT898jusgQJAd5Zrr6Q8
AO/0isr/3aa6O6NLQxISLKcPDk2NOccAfS/xOtfOz4sJYM3+Bs4Io9+dZGSDCA54
Lw03eHTNQghS0A==
-----END PRIVATE KEY-----'''

private_key_decoded = {
    'coefficient': 6263309813628295397107400643432350851721956841159071320214251700452060114366343340155171376140395643703716902907125213041289999255650845147022475122987728L,
    'exponent1': 3822093812252919639580364669476622791207236895386024347699409509479994135036937701181018285803044904622661246121518351058015126950695870028830018671348955L,
    'exponent2': 7663489069477237650921539283392475888713419180290444291436091339476564305244313755637841647317265985369733335137037584327090234814990380934645339788127361L,
    'modulus': 126669640320683290646795148731116725859129871317489646670977486626744987251277308188134951784112892388851824395559423655294483477900467304936849324412630428474313221323982004833431306952809970692055204065814102382627007630050419900189287007179961309761697749877767089292033899335453619375029318017462636143731L,
    'prime1': 11286827475943747777190031061302637221977591331181628336645618033739934917672950305154796350050653535540726809672687251533778100075147804897014055497868539L,
    'prime2': 11222785197227603770299537898098245716808441026517135491773487623240874036306681055667617716308358528851810278532267433054266015352833942512376019701789929L,
    'privateExponent': 62040813352054762141560911837894865241805540983262892236320038195704523334585811305536472791220833007152520122572927352660293042970033721732272250245220614325662189223664266754362230405256661079259461762606569479150278994918928461540639220666195615058859592860192738580413744039865489807787295497665583162801L,
    'publicExponent': 65537L,
    'version': 0L,
}

certificate='''\
-----BEGIN CERTIFICATE-----
MIIBpjCCAQ+gAwIBAgIBATANBgkqhkiG9w0BAQUFADAZMRcwFQYDVQQDDA5UZXN0
IFByaW5jaXBhbDAeFw03MDAxMDEwODAwMDBaFw0zODEyMzEwODAwMDBaMBkxFzAV
BgNVBAMMDlRlc3QgUHJpbmNpcGFsMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKB
gQC0YjCwIfYoprq/FQO6lb3asXrxLlJFuCvtinTF5p0GxvQGu5O3gYytUvtC2JlY
zypSRjVxwxrsuRcP3e641SdASwfrmzyvIgP08N4S0IFzEURkV1wp/IpH7kH41Etb
mUmrXSwfNZsnQRE5SYSOhh+LcK2wyQkdgcMv11l4KoBkcwIDAQABMA0GCSqGSIb3
DQEBBQUAA4GBAGZLPEuJ5SiJ2ryq+CmEGOXfvlTtEL2nuGtr9PewxkgnOjZpUy+d
4TvuXJbNQc8f4AMWL/tO9w0Fk80rWKp9ea8/df4qMq5qlFWlx6yOLQxumNOmECKb
WpkUQDIDJEoFUzKMVuJf4KO/FJ345+BNLGgbJ6WujreoM1X/gYfdnJ/J
-----END CERTIFICATE-----'''

public_key_decoded = {
    'exponent': 65537L,
    'modulus': 126669640320683290646795148731116725859129871317489646670977486626744987251277308188134951784112892388851824395559423655294483477900467304936849324412630428474313221323982004833431306952809970692055204065814102382627007630050419900189287007179961309761697749877767089292033899335453619375029318017462636143731L,
}

public_key='''\
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0YjCwIfYoprq/FQO6lb3asXrx
LlJFuCvtinTF5p0GxvQGu5O3gYytUvtC2JlYzypSRjVxwxrsuRcP3e641SdASwfr
mzyvIgP08N4S0IFzEURkV1wp/IpH7kH41EtbmUmrXSwfNZsnQRE5SYSOhh+LcK2w
yQkdgcMv11l4KoBkcwIDAQAB
-----END PUBLIC KEY-----'''


class Test_public_key_pem_decode(unittest2.TestCase):
    def test_decode(self):
        self.assertDictEqual(public_key_pem_decode(public_key), public_key_decoded)
        self.assertDictEqual(public_key_pem_decode(certificate), public_key_decoded)

    def test_NotImplementedError_when_not_public_key(self):
        self.assertRaises(NotImplementedError, public_key_pem_decode, private_key)


class Test_private_key_pem_decode(unittest2.TestCase):
    def test_decode(self):
        self.assertDictEqual(private_key_pem_decode(private_key), private_key_decoded)

    def test_NotImplementedError_when_not_private_key(self):
        self.assertRaises(NotImplementedError, private_key_pem_decode, public_key)
        self.assertRaises(NotImplementedError, private_key_pem_decode, certificate)
